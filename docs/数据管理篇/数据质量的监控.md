# 数据质量的监控

数据行业有一句很经典的话——"垃圾进,垃圾出"(Garbage in, Garbage out, GIGO)，意思就是如果使用的基础数据有问题那基于这些数据得到的任何产出都是没有价值的.而对于数据分析挖掘而言只有一份高质量的基础数据才可能得到正确有用的结论.因此数据监控是数据管理的一个很重要的环节,主要是为了确保数据/模型的质量,从而确保业务的稳定.

数据监控主要是要做到:

1. 异常数据发现,迅速做出反应
2. 把握整体趋势,了解主要指标的历史状态,评估业务自身状态.

注意本文介绍的数据监控并不是运维概念上的监控,而是对数据的持续监控.运维监控虽然和数据监控在原理上很接近,但并不在本文的讨论范围内.

## 数据质量问题

关于数据质量是有个一个标准定义的:一组固有特性满足明示的,通常隐含的或必须履行的需求或期望(要求)的​程度.这里面包含了两层意思:

+ 一个是说质量其实是一组特性
+ 一个是说质量需要满足需求或期望.

所以如果从数据分析的角度来说数据质量就是看当前数据的特性能否满足我们做数据分析或挖掘这个需求

数据质量问题的来源可能产生于从数据源头到数据存储介质的各个环节.在数据采集阶段,数据的真实性,准确性,完整性,时效性都会影响数据质量.除此之外数据的加工,存储过程都有可能涉及对原始数据的修改,从而引发数据的质量问题.所以技术,流程,管理等多方面的因素都有可能会影响到数据质量.

数据质量管理是一个基础工作,类似系统性能服务监控这些,是基础设施.

相对来说成本比较高.因为它涉及到企业数据标准的制定,规范的落地,生命周期的管理等多个环节.从收益上来说数据质量的效益和结果并不是十分明显(基础设施的投入一般效益都不明显),大部分企业不会把数据质量作为KPI.在企业的不同系统中业务领域的关键指标不一致,数据无法共享导致出现数据孤岛,大量数据无法关联并且有明显的数据冗余等问题,还有数据的维护需要投入大量的人员,时间,软硬件成本.所以数据的质量管理往往被会边缘化甚至趋向于无.

但是,从长远说数据质量却是至关重要的,正如文章开头说的,垃圾进垃圾出,如果数据质量本身不行,虽然不会对业务本身造成影响,但一定会造成数据表现上的偏差,从而误导企业决策,让算法模型无法有效预测.因此监控数据质量就是一个至关重要的工作.


## 数据质量评估

要做数据质量监控首先要可以评估数据质量.那么我们如何对一份数据进行质量评估呢?比较常见的数据质量评估指标是如下几个:

+ `Completeness`: 完整性,用于度量哪些数据丢失了
+ `Effectiveness`：有效性,用于度量哪些数据数据不可用
+ `Consistency`：一致性,用于度量哪些数据的值在信息含义上是冲突的
+ `Accuracy`：准确性,用于度量哪些数据和信息是不正确的.
+ `Uniqueness`：唯一性,用于度量哪些数据是重复数据或者数据的哪些属性是重复的
+ `Timeliness`: 及时性,用于度量数据是否已经过了时效.

往往这些维度不可兼得,就要根据业务需求来设计不同的方案了.

数据质量的评估模型就应该有这么几个要素:

+ `DataAssets`：被评估的数据集,对于静态数据来说就是一张表,对于流数据来说就是一个事件流.
+ `Rule`：评估规则,与上面的评估指标对应,用于描述评估的指标应该满足的要求
+ `Indicators`：评估角度,就是上面列出来的6个指标.

那么构造整个模型的过程基本就可以确定下来:

1. 首先根据需要选取数据集当中要进行评估的数据
2. 再选取所需要的评估指标
3. 下一步需要制定规则集根据所选的评估指标来制定相应的数据质量评估规则
4. 根据规则集执行的结果设定指标的阈值来评估数据质量

## 数据工作流中的数据质量管理

数据的工作流可以分为数据产生,加工处理,存储,挖掘和应用.质量管理的前提是在每一个环节建立质量标准.除了上面的常规监控外,还应在外部对数据进行定期抽检校验.这个可以根据不同的业务按需要进行.通常越重要的业务抽检频次应该更高,抽检覆盖范围应该更大.

目前比较通用的方案是使用[Apache Griffin](https://github.com/apache/griffin).通常我们对数据的监控可以拆分成两类数据如下几个任务:

+ 事件流数据
  事件数据流通常我们
  1. 检验事件数据的实时性,也就是事件记录事件与事件发生时间的差距.通常我们会记录下这两个时间的时间戳然后做减法校验
  2. 校验事件数据的完整性,主要是缺值情况,通常缺值数据可以认为是无效的.
  3. 校验数据的波动检查,检查同一事件中特定连续型数据的波动变化,比如一些稳定数据是否有突变

+ 静态数据
  静态数据质量检查是在完成宽表数据开发后进行的,主要包括四个方面:
  + 重复值检查
  + 缺失值检查
  + 数据倾斜检查
  + 异常值检查
