# BASE理论

BASE是对[CAP理论]()中一致性和可用性权衡的结果,其来源于对大规模互联网分布式系统实践的总结,是基于CAP定律逐步演化而来.其核心思想是即使无法做到`强一致性`,但每个应用都可以根据自身业务特点采用适当的方式来使系统达到最终一致性.

## 内容

+ 基本可用(Basically Available)
+ 软状态(Soft State)
+ 最终一致性(Eventually Consistent)

### 基本可用

什么是基本可用呢?假设系统出现了不可预知的故障但还是能用,相比较正常的系统而言:

1. 响应时间上的损失:正常情况下的搜索引擎0.5秒即返回给用户结果,而基本可用的搜索引擎可以在2秒作用返回结果.
2. 功能上的损失:在一个电商网站上,正常情况下用户可以顺利完成每一笔订单.但是到了大促期间为了保护购物系统的稳定性,部分消费者可能会被引导到一个降级页面.

### 软状态

什么是软状态呢?相对于原子性而言,要求多个节点的数据副本都是一致的,这是一种"硬状态".

软状态指允许系统中的数据存在中间状态,并认为该状态不影响系统的整体可用性.即允许系统在多个不同节点的数据副本存在数据延时.

### 最终一致性

在[CAP理论的一致性部分]()我们大致介绍了下最终一致性.实际上，不只是分布式系统使用最终一致性,关系型数据库在某些功能上也是使用最终一致性的,比如备份.数据库的复制过程是需要时间的,这个复制过程中业务读取到的值就是旧的.当然最终还是达成了数据一致性.这也算是一个最终一致性的经典案例.

分布式系统的最终一致性和软状态有一定关系,一次操作不可能让节点一直是软状态,必须有个时间期限.在期限过后应当保证所有副本保持数据一致性,从而达到数据的最终一致性.这个时间期限取决于网络延时,系统负载,数据复制方案设计等等因素.

而在实际工程实践中,最终一致性分为5种,在实际的实践中这5种系统往往会结合使用以构建一个具有最终一致性的分布式系统.

#### 因果一致性(Causal consistency)

因果一致性指的是如果节点A在更新完某个数据后通知了节点B,那么节点B之后对该数据的访问和修改都是基于A更新后的值.于此同时和节点A无因果关系的节点C的数据访问则没有这样的限制.

#### 读己之所写(Read your writes)

读己之所写指的是节点A更新一个数据后,它自身总是能访问到自身更新过的最新值,而不会看到旧值.其实也算一种因果一致性.

#### 会话一致性(Session consistency)

会话一致性将对系统数据的访问过程框定在了一个会话当中--系统能保证在同一个有效的会话中实现'读己之所写'的一致性,也就是说执行更新操作之后,客户端能够在同一个会话中始终读取到该数据项的最新值.

#### 单调读一致性(Monotonic read consistency)

单调读一致性指的是如果一个节点从系统中读取出一个数据项的某个值后,那么系统对于该节点后续的任何数据访问都不应该返回更旧的值.

#### 单调写一致性(Monotonic write consistency)

单调写一致性指的是一个系统要能够保证来自同一个节点的写操作被顺序的执行.
